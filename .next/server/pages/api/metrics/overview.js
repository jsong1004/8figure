"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/metrics/overview";
exports.ids = ["pages/api/metrics/overview"];
exports.modules = {

/***/ "@google-cloud/bigquery":
/*!*****************************************!*\
  !*** external "@google-cloud/bigquery" ***!
  \*****************************************/
/***/ ((module) => {

module.exports = require("@google-cloud/bigquery");

/***/ }),

/***/ "google-auth-library":
/*!**************************************!*\
  !*** external "google-auth-library" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("google-auth-library");

/***/ }),

/***/ "next-auth":
/*!****************************!*\
  !*** external "next-auth" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("next-auth");

/***/ }),

/***/ "next-auth/next":
/*!*********************************!*\
  !*** external "next-auth/next" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("next-auth/next");

/***/ }),

/***/ "next-auth/providers/google":
/*!*********************************************!*\
  !*** external "next-auth/providers/google" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/google");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Foverview&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmetrics%2Foverview.ts&middlewareConfigBase64=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Foverview&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmetrics%2Foverview.ts&middlewareConfigBase64=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_metrics_overview_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/metrics/overview.ts */ \"(api)/./pages/api/metrics/overview.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_metrics_overview_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_metrics_overview_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/metrics/overview\",\n        pathname: \"/api/metrics/overview\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_metrics_overview_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4wLjRfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRm1ldHJpY3MlMkZvdmVydmlldyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGbWV0cmljcyUyRm92ZXJ2aWV3LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzREO0FBQzVEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywyREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMkRBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmlncXVlcnktYWRzLWFuYWx5dGljcy8/MzU0MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL21ldHJpY3Mvb3ZlcnZpZXcudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tZXRyaWNzL292ZXJ2aWV3XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWV0cmljcy9vdmVydmlld1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Foverview&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmetrics%2Foverview.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/bigquery.ts":
/*!*************************!*\
  !*** ./lib/bigquery.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getBigQueryClient: () => (/* binding */ getBigQueryClient),\n/* harmony export */   getBigQueryClientWithToken: () => (/* binding */ getBigQueryClientWithToken),\n/* harmony export */   getTableSchema: () => (/* binding */ getTableSchema),\n/* harmony export */   runQuery: () => (/* binding */ runQuery)\n/* harmony export */ });\n/* harmony import */ var _google_cloud_bigquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google-cloud/bigquery */ \"@google-cloud/bigquery\");\n/* harmony import */ var _google_cloud_bigquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_google_cloud_bigquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var google_auth_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! google-auth-library */ \"google-auth-library\");\n/* harmony import */ var google_auth_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(google_auth_library__WEBPACK_IMPORTED_MODULE_1__);\n\n\nlet bigqueryClient = null;\nfunction getBigQueryClient() {\n    if (!bigqueryClient) {\n        const auth = new google_auth_library__WEBPACK_IMPORTED_MODULE_1__.GoogleAuth({\n            scopes: [\n                \"https://www.googleapis.com/auth/bigquery\"\n            ],\n            credentials: {\n                client_id: process.env.GOOGLE_CLIENT_ID,\n                client_secret: process.env.GOOGLE_CLIENT_SECRET,\n                refresh_token: process.env.GOOGLE_REFRESH_TOKEN,\n                type: \"authorized_user\"\n            }\n        });\n        bigqueryClient = new _google_cloud_bigquery__WEBPACK_IMPORTED_MODULE_0__.BigQuery({\n            projectId: \"ai-biz-6b7ec\",\n            auth\n        });\n    }\n    return bigqueryClient;\n}\nasync function getBigQueryClientWithToken(accessToken) {\n    const auth = new google_auth_library__WEBPACK_IMPORTED_MODULE_1__.GoogleAuth({\n        scopes: [\n            \"https://www.googleapis.com/auth/bigquery\"\n        ]\n    });\n    // Set the access token\n    const authClient = await auth.getClient();\n    authClient.credentials = {\n        access_token: accessToken\n    };\n    return new _google_cloud_bigquery__WEBPACK_IMPORTED_MODULE_0__.BigQuery({\n        projectId: \"ai-biz-6b7ec\",\n        auth: authClient\n    });\n}\nasync function runQuery(query) {\n    const bigquery = getBigQueryClient();\n    const [rows] = await bigquery.query({\n        query,\n        location: \"us-west1\" || 0\n    });\n    return rows;\n}\nasync function getTableSchema() {\n    const bigquery = getBigQueryClient();\n    const dataset = bigquery.dataset(\"n8n\");\n    const table = dataset.table(\"ads_spend\");\n    const [metadata] = await table.getMetadata();\n    return metadata.schema.fields.map((field)=>({\n            name: field.name,\n            type: field.type,\n            mode: field.mode || \"NULLABLE\",\n            description: field.description || \"\"\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYmlncXVlcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBa0Q7QUFDRDtBQUVqRCxJQUFJRSxpQkFBa0M7QUFFL0IsU0FBU0M7SUFDZCxJQUFJLENBQUNELGdCQUFnQjtRQUNuQixNQUFNRSxPQUFPLElBQUlILDJEQUFVQSxDQUFDO1lBQzFCSSxRQUFRO2dCQUFDO2FBQTJDO1lBQ3BEQyxhQUFhO2dCQUNYQyxXQUFXQyxRQUFRQyxHQUFHLENBQUNDLGdCQUFnQjtnQkFDdkNDLGVBQWVILFFBQVFDLEdBQUcsQ0FBQ0csb0JBQW9CO2dCQUMvQ0MsZUFBZUwsUUFBUUMsR0FBRyxDQUFDSyxvQkFBb0I7Z0JBQy9DQyxNQUFNO1lBQ1I7UUFDRjtRQUVBYixpQkFBaUIsSUFBSUYsNERBQVFBLENBQUM7WUFDNUJnQixXQUFXUixjQUFzQjtZQUNqQ0o7UUFDRjtJQUNGO0lBQ0EsT0FBT0Y7QUFDVDtBQUVPLGVBQWVnQiwyQkFBMkJDLFdBQW1CO0lBQ2xFLE1BQU1mLE9BQU8sSUFBSUgsMkRBQVVBLENBQUM7UUFDMUJJLFFBQVE7WUFBQztTQUEyQztJQUN0RDtJQUVBLHVCQUF1QjtJQUN2QixNQUFNZSxhQUFhLE1BQU1oQixLQUFLaUIsU0FBUztJQUN2Q0QsV0FBV2QsV0FBVyxHQUFHO1FBQUVnQixjQUFjSDtJQUFZO0lBRXJELE9BQU8sSUFBSW5CLDREQUFRQSxDQUFDO1FBQ2xCZ0IsV0FBV1IsY0FBc0I7UUFDakNKLE1BQU1nQjtJQUNSO0FBQ0Y7QUFFTyxlQUFlRyxTQUFTQyxLQUFhO0lBQzFDLE1BQU1DLFdBQVd0QjtJQUNqQixNQUFNLENBQUN1QixLQUFLLEdBQUcsTUFBTUQsU0FBU0QsS0FBSyxDQUFDO1FBQ2xDQTtRQUNBRyxVQUFVbkIsVUFBNkIsSUFBSTtJQUM3QztJQUNBLE9BQU9rQjtBQUNUO0FBRU8sZUFBZUc7SUFDcEIsTUFBTUosV0FBV3RCO0lBQ2pCLE1BQU0yQixVQUFVTCxTQUFTSyxPQUFPLENBQUN0QixLQUFzQjtJQUN2RCxNQUFNd0IsUUFBUUYsUUFBUUUsS0FBSyxDQUFDeEIsV0FBb0I7SUFDaEQsTUFBTSxDQUFDMEIsU0FBUyxHQUFHLE1BQU1GLE1BQU1HLFdBQVc7SUFFMUMsT0FBT0QsU0FBU0UsTUFBTSxDQUFDQyxNQUFNLENBQUNDLEdBQUcsQ0FBQyxDQUFDQyxRQUFnQjtZQUNqREMsTUFBTUQsTUFBTUMsSUFBSTtZQUNoQnpCLE1BQU13QixNQUFNeEIsSUFBSTtZQUNoQjBCLE1BQU1GLE1BQU1FLElBQUksSUFBSTtZQUNwQkMsYUFBYUgsTUFBTUcsV0FBVyxJQUFJO1FBQ3BDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaWdxdWVyeS1hZHMtYW5hbHl0aWNzLy4vbGliL2JpZ3F1ZXJ5LnRzPzQwOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmlnUXVlcnkgfSBmcm9tICdAZ29vZ2xlLWNsb3VkL2JpZ3F1ZXJ5JztcbmltcG9ydCB7IEdvb2dsZUF1dGggfSBmcm9tICdnb29nbGUtYXV0aC1saWJyYXJ5JztcblxubGV0IGJpZ3F1ZXJ5Q2xpZW50OiBCaWdRdWVyeSB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmlnUXVlcnlDbGllbnQoKSB7XG4gIGlmICghYmlncXVlcnlDbGllbnQpIHtcbiAgICBjb25zdCBhdXRoID0gbmV3IEdvb2dsZUF1dGgoe1xuICAgICAgc2NvcGVzOiBbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvYmlncXVlcnknXSxcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGNsaWVudF9pZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCxcbiAgICAgICAgY2xpZW50X3NlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQsXG4gICAgICAgIHJlZnJlc2hfdG9rZW46IHByb2Nlc3MuZW52LkdPT0dMRV9SRUZSRVNIX1RPS0VOLFxuICAgICAgICB0eXBlOiAnYXV0aG9yaXplZF91c2VyJyxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBiaWdxdWVyeUNsaWVudCA9IG5ldyBCaWdRdWVyeSh7XG4gICAgICBwcm9qZWN0SWQ6IHByb2Nlc3MuZW52LlBST0pFQ1RfSUQsXG4gICAgICBhdXRoLFxuICAgIH0pO1xuICB9XG4gIHJldHVybiBiaWdxdWVyeUNsaWVudDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJpZ1F1ZXJ5Q2xpZW50V2l0aFRva2VuKGFjY2Vzc1Rva2VuOiBzdHJpbmcpIHtcbiAgY29uc3QgYXV0aCA9IG5ldyBHb29nbGVBdXRoKHtcbiAgICBzY29wZXM6IFsnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9iaWdxdWVyeSddLFxuICB9KTtcbiAgXG4gIC8vIFNldCB0aGUgYWNjZXNzIHRva2VuXG4gIGNvbnN0IGF1dGhDbGllbnQgPSBhd2FpdCBhdXRoLmdldENsaWVudCgpO1xuICBhdXRoQ2xpZW50LmNyZWRlbnRpYWxzID0geyBhY2Nlc3NfdG9rZW46IGFjY2Vzc1Rva2VuIH07XG4gIFxuICByZXR1cm4gbmV3IEJpZ1F1ZXJ5KHtcbiAgICBwcm9qZWN0SWQ6IHByb2Nlc3MuZW52LlBST0pFQ1RfSUQsXG4gICAgYXV0aDogYXV0aENsaWVudCxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5RdWVyeShxdWVyeTogc3RyaW5nKSB7XG4gIGNvbnN0IGJpZ3F1ZXJ5ID0gZ2V0QmlnUXVlcnlDbGllbnQoKTtcbiAgY29uc3QgW3Jvd3NdID0gYXdhaXQgYmlncXVlcnkucXVlcnkoe1xuICAgIHF1ZXJ5LFxuICAgIGxvY2F0aW9uOiBwcm9jZXNzLmVudi5CSUdRVUVSWV9MT0NBVElPTiB8fCAnVVMnLFxuICB9KTtcbiAgcmV0dXJuIHJvd3M7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUYWJsZVNjaGVtYSgpIHtcbiAgY29uc3QgYmlncXVlcnkgPSBnZXRCaWdRdWVyeUNsaWVudCgpO1xuICBjb25zdCBkYXRhc2V0ID0gYmlncXVlcnkuZGF0YXNldChwcm9jZXNzLmVudi5EQVRBU0VUX0lEISk7XG4gIGNvbnN0IHRhYmxlID0gZGF0YXNldC50YWJsZShwcm9jZXNzLmVudi5UQUJMRV9JRCEpO1xuICBjb25zdCBbbWV0YWRhdGFdID0gYXdhaXQgdGFibGUuZ2V0TWV0YWRhdGEoKTtcbiAgXG4gIHJldHVybiBtZXRhZGF0YS5zY2hlbWEuZmllbGRzLm1hcCgoZmllbGQ6IGFueSkgPT4gKHtcbiAgICBuYW1lOiBmaWVsZC5uYW1lLFxuICAgIHR5cGU6IGZpZWxkLnR5cGUsXG4gICAgbW9kZTogZmllbGQubW9kZSB8fCAnTlVMTEFCTEUnLFxuICAgIGRlc2NyaXB0aW9uOiBmaWVsZC5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgfSkpO1xufSJdLCJuYW1lcyI6WyJCaWdRdWVyeSIsIkdvb2dsZUF1dGgiLCJiaWdxdWVyeUNsaWVudCIsImdldEJpZ1F1ZXJ5Q2xpZW50IiwiYXV0aCIsInNjb3BlcyIsImNyZWRlbnRpYWxzIiwiY2xpZW50X2lkIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9DTElFTlRfSUQiLCJjbGllbnRfc2VjcmV0IiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiLCJyZWZyZXNoX3Rva2VuIiwiR09PR0xFX1JFRlJFU0hfVE9LRU4iLCJ0eXBlIiwicHJvamVjdElkIiwiUFJPSkVDVF9JRCIsImdldEJpZ1F1ZXJ5Q2xpZW50V2l0aFRva2VuIiwiYWNjZXNzVG9rZW4iLCJhdXRoQ2xpZW50IiwiZ2V0Q2xpZW50IiwiYWNjZXNzX3Rva2VuIiwicnVuUXVlcnkiLCJxdWVyeSIsImJpZ3F1ZXJ5Iiwicm93cyIsImxvY2F0aW9uIiwiQklHUVVFUllfTE9DQVRJT04iLCJnZXRUYWJsZVNjaGVtYSIsImRhdGFzZXQiLCJEQVRBU0VUX0lEIiwidGFibGUiLCJUQUJMRV9JRCIsIm1ldGFkYXRhIiwiZ2V0TWV0YWRhdGEiLCJzY2hlbWEiLCJmaWVsZHMiLCJtYXAiLCJmaWVsZCIsIm5hbWUiLCJtb2RlIiwiZGVzY3JpcHRpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/bigquery.ts\n");

/***/ }),

/***/ "(api)/./pages/api/auth/[...nextauth].ts":
/*!*****************************************!*\
  !*** ./pages/api/auth/[...nextauth].ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"next-auth\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"next-auth/providers/google\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Ensure NEXTAUTH_SECRET is set\nif (!process.env.NEXTAUTH_SECRET) {\n    throw new Error(\"NEXTAUTH_SECRET environment variable is required\");\n}\nconst authOptions = {\n    providers: [\n        next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default()({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n            authorization: {\n                params: {\n                    scope: \"openid email profile https://www.googleapis.com/auth/bigquery\",\n                    access_type: \"offline\",\n                    prompt: \"consent\"\n                }\n            }\n        })\n    ],\n    secret: process.env.NEXTAUTH_SECRET,\n    callbacks: {\n        async jwt ({ token, account }) {\n            try {\n                // Persist the OAuth access_token and refresh_token to the token right after signin\n                if (account) {\n                    token.accessToken = account.access_token;\n                    token.refreshToken = account.refresh_token;\n                    token.accessTokenExpires = account.expires_at;\n                }\n                // Return previous token if the access token has not expired yet\n                if (token.accessTokenExpires && Date.now() < token.accessTokenExpires * 1000) {\n                    return token;\n                }\n                // Access token has expired, try to update it\n                if (token.refreshToken) {\n                    return await refreshAccessToken(token);\n                }\n                return token;\n            } catch (error) {\n                console.error(\"JWT callback error:\", error);\n                return {\n                    ...token,\n                    error: \"RefreshAccessTokenError\"\n                };\n            }\n        },\n        async session ({ session, token }) {\n            // Send properties to the client\n            session.accessToken = token.accessToken;\n            session.error = token.error;\n            return session;\n        }\n    },\n    debug: \"development\" === \"development\",\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    }\n};\nasync function refreshAccessToken(token) {\n    try {\n        if (!token.refreshToken) {\n            throw new Error(\"No refresh token available\");\n        }\n        const url = \"https://oauth2.googleapis.com/token\";\n        const response = await fetch(url, {\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: new URLSearchParams({\n                client_id: process.env.GOOGLE_CLIENT_ID,\n                client_secret: process.env.GOOGLE_CLIENT_SECRET,\n                grant_type: \"refresh_token\",\n                refresh_token: token.refreshToken\n            }),\n            method: \"POST\"\n        });\n        const refreshedTokens = await response.json();\n        if (!response.ok) {\n            console.error(\"Token refresh failed:\", refreshedTokens);\n            throw new Error(refreshedTokens.error_description || refreshedTokens.error || \"Token refresh failed\");\n        }\n        return {\n            ...token,\n            accessToken: refreshedTokens.access_token,\n            accessTokenExpires: Date.now() + refreshedTokens.expires_in * 1000,\n            refreshToken: refreshedTokens.refresh_token ?? token.refreshToken,\n            error: undefined\n        };\n    } catch (error) {\n        console.error(\"Error refreshing access token:\", error);\n        return {\n            ...token,\n            error: \"RefreshAccessTokenError\"\n        };\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (next_auth__WEBPACK_IMPORTED_MODULE_0___default()(authOptions));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUksWUFBWTtZQUNqRU8sT0FBT3FCO1FBQ1Q7SUFDRixFQUFFLE9BQU9yQixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxrQ0FBa0NBO1FBRWhELE9BQU87WUFDTCxHQUFHWCxLQUFLO1lBQ1JXLE9BQU87UUFDVDtJQUNGO0FBQ0Y7QUFFQSxpRUFBZS9CLGdEQUFRQSxDQUFDTSxZQUFZQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmlncXVlcnktYWRzLWFuYWx5dGljcy8uL3BhZ2VzL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0udHM/MmU4YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGgsIHsgTmV4dEF1dGhPcHRpb25zIH0gZnJvbSAnbmV4dC1hdXRoJztcbmltcG9ydCBHb29nbGVQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2dvb2dsZSc7XG5cbi8vIEVuc3VyZSBORVhUQVVUSF9TRUNSRVQgaXMgc2V0XG5pZiAoIXByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ05FWFRBVVRIX1NFQ1JFVCBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyByZXF1aXJlZCcpO1xufVxuXG5leHBvcnQgY29uc3QgYXV0aE9wdGlvbnM6IE5leHRBdXRoT3B0aW9ucyA9IHtcbiAgcHJvdmlkZXJzOiBbXG4gICAgR29vZ2xlUHJvdmlkZXIoe1xuICAgICAgY2xpZW50SWQ6IHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQhLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCEsXG4gICAgICBhdXRob3JpemF0aW9uOiB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHNjb3BlOiAnb3BlbmlkIGVtYWlsIHByb2ZpbGUgaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9iaWdxdWVyeScsXG4gICAgICAgICAgYWNjZXNzX3R5cGU6ICdvZmZsaW5lJyxcbiAgICAgICAgICBwcm9tcHQ6ICdjb25zZW50JyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSksXG4gIF0sXG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgYWNjb3VudCB9KSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBQZXJzaXN0IHRoZSBPQXV0aCBhY2Nlc3NfdG9rZW4gYW5kIHJlZnJlc2hfdG9rZW4gdG8gdGhlIHRva2VuIHJpZ2h0IGFmdGVyIHNpZ25pblxuICAgICAgICBpZiAoYWNjb3VudCkge1xuICAgICAgICAgIHRva2VuLmFjY2Vzc1Rva2VuID0gYWNjb3VudC5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgdG9rZW4ucmVmcmVzaFRva2VuID0gYWNjb3VudC5yZWZyZXNoX3Rva2VuO1xuICAgICAgICAgIHRva2VuLmFjY2Vzc1Rva2VuRXhwaXJlcyA9IGFjY291bnQuZXhwaXJlc19hdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiBwcmV2aW91cyB0b2tlbiBpZiB0aGUgYWNjZXNzIHRva2VuIGhhcyBub3QgZXhwaXJlZCB5ZXRcbiAgICAgICAgaWYgKHRva2VuLmFjY2Vzc1Rva2VuRXhwaXJlcyAmJiBEYXRlLm5vdygpIDwgKHRva2VuLmFjY2Vzc1Rva2VuRXhwaXJlcyBhcyBudW1iZXIpICogMTAwMCkge1xuICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFjY2VzcyB0b2tlbiBoYXMgZXhwaXJlZCwgdHJ5IHRvIHVwZGF0ZSBpdFxuICAgICAgICBpZiAodG9rZW4ucmVmcmVzaFRva2VuKSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJlZnJlc2hBY2Nlc3NUb2tlbih0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdKV1QgY2FsbGJhY2sgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnRva2VuLFxuICAgICAgICAgIGVycm9yOiAnUmVmcmVzaEFjY2Vzc1Rva2VuRXJyb3InLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH0pIHtcbiAgICAgIC8vIFNlbmQgcHJvcGVydGllcyB0byB0aGUgY2xpZW50XG4gICAgICBzZXNzaW9uLmFjY2Vzc1Rva2VuID0gdG9rZW4uYWNjZXNzVG9rZW47XG4gICAgICBzZXNzaW9uLmVycm9yID0gdG9rZW4uZXJyb3I7XG4gICAgICByZXR1cm4gc2Vzc2lvbjtcbiAgICB9LFxuICB9LFxuICBkZWJ1ZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcsXG4gIHBhZ2VzOiB7XG4gICAgc2lnbkluOiAnL2F1dGgvc2lnbmluJyxcbiAgICBlcnJvcjogJy9hdXRoL2Vycm9yJyxcbiAgfSxcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hBY2Nlc3NUb2tlbih0b2tlbjogYW55KSB7XG4gIHRyeSB7XG4gICAgaWYgKCF0b2tlbi5yZWZyZXNoVG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gcmVmcmVzaCB0b2tlbiBhdmFpbGFibGUnKTtcbiAgICB9XG5cbiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4nO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgY2xpZW50X2lkOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lEISxcbiAgICAgICAgY2xpZW50X3NlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQhLFxuICAgICAgICBncmFudF90eXBlOiAncmVmcmVzaF90b2tlbicsXG4gICAgICAgIHJlZnJlc2hfdG9rZW46IHRva2VuLnJlZnJlc2hUb2tlbixcbiAgICAgIH0pLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZWZyZXNoZWRUb2tlbnMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCByZWZyZXNoZWRUb2tlbnMpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlZnJlc2hlZFRva2Vucy5lcnJvcl9kZXNjcmlwdGlvbiB8fCByZWZyZXNoZWRUb2tlbnMuZXJyb3IgfHwgJ1Rva2VuIHJlZnJlc2ggZmFpbGVkJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnRva2VuLFxuICAgICAgYWNjZXNzVG9rZW46IHJlZnJlc2hlZFRva2Vucy5hY2Nlc3NfdG9rZW4sXG4gICAgICBhY2Nlc3NUb2tlbkV4cGlyZXM6IERhdGUubm93KCkgKyAocmVmcmVzaGVkVG9rZW5zLmV4cGlyZXNfaW4gKiAxMDAwKSxcbiAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaGVkVG9rZW5zLnJlZnJlc2hfdG9rZW4gPz8gdG9rZW4ucmVmcmVzaFRva2VuLFxuICAgICAgZXJyb3I6IHVuZGVmaW5lZCwgLy8gQ2xlYXIgYW55IHByZXZpb3VzIGVycm9yc1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyBhY2Nlc3MgdG9rZW46JywgZXJyb3IpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnRva2VuLFxuICAgICAgZXJyb3I6ICdSZWZyZXNoQWNjZXNzVG9rZW5FcnJvcicsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZXh0QXV0aChhdXRoT3B0aW9ucyk7Il0sIm5hbWVzIjpbIk5leHRBdXRoIiwiR29vZ2xlUHJvdmlkZXIiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwiRXJyb3IiLCJhdXRoT3B0aW9ucyIsInByb3ZpZGVycyIsImNsaWVudElkIiwiR09PR0xFX0NMSUVOVF9JRCIsImNsaWVudFNlY3JldCIsIkdPT0dMRV9DTElFTlRfU0VDUkVUIiwiYXV0aG9yaXphdGlvbiIsInBhcmFtcyIsInNjb3BlIiwiYWNjZXNzX3R5cGUiLCJwcm9tcHQiLCJzZWNyZXQiLCJjYWxsYmFja3MiLCJqd3QiLCJ0b2tlbiIsImFjY291bnQiLCJhY2Nlc3NUb2tlbiIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hUb2tlbiIsInJlZnJlc2hfdG9rZW4iLCJhY2Nlc3NUb2tlbkV4cGlyZXMiLCJleHBpcmVzX2F0IiwiRGF0ZSIsIm5vdyIsInJlZnJlc2hBY2Nlc3NUb2tlbiIsImVycm9yIiwiY29uc29sZSIsInNlc3Npb24iLCJkZWJ1ZyIsInBhZ2VzIiwic2lnbkluIiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJib2R5IiwiVVJMU2VhcmNoUGFyYW1zIiwiY2xpZW50X2lkIiwiY2xpZW50X3NlY3JldCIsImdyYW50X3R5cGUiLCJtZXRob2QiLCJyZWZyZXNoZWRUb2tlbnMiLCJqc29uIiwib2siLCJlcnJvcl9kZXNjcmlwdGlvbiIsImV4cGlyZXNfaW4iLCJ1bmRlZmluZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/[...nextauth].ts\n");

/***/ }),

/***/ "(api)/./pages/api/metrics/overview.ts":
/*!***************************************!*\
  !*** ./pages/api/metrics/overview.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/next */ \"next-auth/next\");\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_next__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _auth_nextauth___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../auth/[...nextauth] */ \"(api)/./pages/api/auth/[...nextauth].ts\");\n/* harmony import */ var _lib_bigquery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/bigquery */ \"(api)/./lib/bigquery.ts\");\n\n\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    // Check authentication\n    const session = await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(req, res, _auth_nextauth___WEBPACK_IMPORTED_MODULE_1__.authOptions);\n    if (!session || !session.accessToken) {\n        return res.status(401).json({\n            error: \"Authentication required\"\n        });\n    }\n    try {\n        const { days = \"30\" } = req.query;\n        const daysInt = parseInt(days);\n        const tableName = `\\`${\"ai-biz-6b7ec\"}.${\"n8n\"}.${\"ads_spend\"}\\``;\n        const query = `\n      SELECT \n        COUNT(DISTINCT date) as days_with_data,\n        SUM(spend) as total_spend,\n        SUM(clicks) as total_clicks,\n        SUM(impressions) as total_impressions,\n        SUM(conversions) as total_conversions,\n        ROUND(SUM(spend) / NULLIF(SUM(conversions), 0), 2) as overall_cac,\n        ROUND(SUM(spend) / NULLIF(SUM(clicks), 0), 2) as overall_cpc,\n        ROUND(SUM(clicks) / NULLIF(SUM(impressions), 0) * 100, 2) as overall_ctr,\n        ROUND(SUM(conversions) / NULLIF(SUM(clicks), 0) * 100, 2) as overall_cvr\n      FROM ${tableName}\n      WHERE date >= DATE_SUB(CURRENT_DATE(), INTERVAL ${daysInt} DAY)\n    `;\n        // Execute the query with user's access token\n        const bigquery = await (0,_lib_bigquery__WEBPACK_IMPORTED_MODULE_2__.getBigQueryClientWithToken)(session.accessToken);\n        const [rows] = await bigquery.query({\n            query,\n            location: \"us-west1\" || 0\n        });\n        res.status(200).json({\n            success: true,\n            period: `Last ${days} days`,\n            metrics: rows[0]\n        });\n    } catch (error) {\n        console.error(\"Metrics query error:\", error);\n        // Handle specific BigQuery errors\n        if (error.code === 404) {\n            res.status(404).json({\n                success: false,\n                error: \"Dataset or table not found. Please check your BigQuery configuration.\",\n                code: \"RESOURCE_NOT_FOUND\",\n                details: {\n                    message: error.message,\n                    suggestion: \"Verify your PROJECT_ID, DATASET_ID, and TABLE_ID in the environment variables.\"\n                }\n            });\n        } else if (error.code === 403) {\n            res.status(403).json({\n                success: false,\n                error: \"Access denied to BigQuery resource.\",\n                code: \"ACCESS_DENIED\",\n                details: {\n                    message: error.message,\n                    suggestion: \"Ensure your Google account has BigQuery Data Viewer and Job User permissions.\"\n                }\n            });\n        } else {\n            res.status(500).json({\n                success: false,\n                error: error.message\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvbWV0cmljcy9vdmVydmlldy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNrRDtBQUNFO0FBQ1E7QUFFN0MsZUFBZUcsUUFDNUJDLEdBQW1CLEVBQ25CQyxHQUFvQjtJQUVwQixJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTztRQUN4QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSx1QkFBdUI7SUFDdkIsTUFBTUMsVUFBVSxNQUFNVixnRUFBZ0JBLENBQUNJLEtBQUtDLEtBQUtKLHdEQUFXQTtJQUM1RCxJQUFJLENBQUNTLFdBQVcsQ0FBQ0EsUUFBUUMsV0FBVyxFQUFFO1FBQ3BDLE9BQU9OLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUEwQjtJQUNqRTtJQUVBLElBQUk7UUFDRixNQUFNLEVBQUVHLE9BQU8sSUFBSSxFQUFFLEdBQUdSLElBQUlTLEtBQUs7UUFDakMsTUFBTUMsVUFBVUMsU0FBU0g7UUFDekIsTUFBTUksWUFBWSxDQUFDLEVBQUUsRUFBRUMsY0FBc0IsQ0FBQyxDQUFDLEVBQUVBLEtBQXNCLENBQUMsQ0FBQyxFQUFFQSxXQUFvQixDQUFDLEVBQUUsQ0FBQztRQUVuRyxNQUFNSixRQUFRLENBQUM7Ozs7Ozs7Ozs7O1dBV1IsRUFBRUcsVUFBVTtzREFDK0IsRUFBRUYsUUFBUTtJQUM1RCxDQUFDO1FBRUQsNkNBQTZDO1FBQzdDLE1BQU1RLFdBQVcsTUFBTXBCLHlFQUEwQkEsQ0FBQ1EsUUFBUUMsV0FBVztRQUNyRSxNQUFNLENBQUNZLEtBQUssR0FBRyxNQUFNRCxTQUFTVCxLQUFLLENBQUM7WUFDbENBO1lBQ0FXLFVBQVVQLFVBQTZCLElBQUk7UUFDN0M7UUFFQVosSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUNuQmtCLFNBQVM7WUFDVEMsUUFBUSxDQUFDLEtBQUssRUFBRWYsS0FBSyxLQUFLLENBQUM7WUFDM0JnQixTQUFTTCxJQUFJLENBQUMsRUFBRTtRQUNsQjtJQUVGLEVBQUUsT0FBT2QsT0FBWTtRQUNuQm9CLFFBQVFwQixLQUFLLENBQUMsd0JBQXdCQTtRQUV0QyxrQ0FBa0M7UUFDbEMsSUFBSUEsTUFBTXFCLElBQUksS0FBSyxLQUFLO1lBQ3RCekIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDbkJrQixTQUFTO2dCQUNUakIsT0FBTztnQkFDUHFCLE1BQU07Z0JBQ05DLFNBQVM7b0JBQ1BDLFNBQVN2QixNQUFNdUIsT0FBTztvQkFDdEJDLFlBQVk7Z0JBQ2Q7WUFDRjtRQUNGLE9BQU8sSUFBSXhCLE1BQU1xQixJQUFJLEtBQUssS0FBSztZQUM3QnpCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQ25Ca0IsU0FBUztnQkFDVGpCLE9BQU87Z0JBQ1BxQixNQUFNO2dCQUNOQyxTQUFTO29CQUNQQyxTQUFTdkIsTUFBTXVCLE9BQU87b0JBQ3RCQyxZQUFZO2dCQUNkO1lBQ0Y7UUFDRixPQUFPO1lBQ0w1QixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUNuQmtCLFNBQVM7Z0JBQ1RqQixPQUFPQSxNQUFNdUIsT0FBTztZQUN0QjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2JpZ3F1ZXJ5LWFkcy1hbmFseXRpY3MvLi9wYWdlcy9hcGkvbWV0cmljcy9vdmVydmlldy50cz9iMTIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aC9uZXh0JztcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnLi4vYXV0aC9bLi4ubmV4dGF1dGhdJztcbmltcG9ydCB7IGdldEJpZ1F1ZXJ5Q2xpZW50V2l0aFRva2VuIH0gZnJvbSAnQC9saWIvYmlncXVlcnknO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKHJlcSwgcmVzLCBhdXRoT3B0aW9ucyk7XG4gIGlmICghc2Vzc2lvbiB8fCAhc2Vzc2lvbi5hY2Nlc3NUb2tlbikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRheXMgPSAnMzAnIH0gPSByZXEucXVlcnk7XG4gICAgY29uc3QgZGF5c0ludCA9IHBhcnNlSW50KGRheXMgYXMgc3RyaW5nKTtcbiAgICBjb25zdCB0YWJsZU5hbWUgPSBgXFxgJHtwcm9jZXNzLmVudi5QUk9KRUNUX0lEfS4ke3Byb2Nlc3MuZW52LkRBVEFTRVRfSUR9LiR7cHJvY2Vzcy5lbnYuVEFCTEVfSUR9XFxgYDtcbiAgICBcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgQ09VTlQoRElTVElOQ1QgZGF0ZSkgYXMgZGF5c193aXRoX2RhdGEsXG4gICAgICAgIFNVTShzcGVuZCkgYXMgdG90YWxfc3BlbmQsXG4gICAgICAgIFNVTShjbGlja3MpIGFzIHRvdGFsX2NsaWNrcyxcbiAgICAgICAgU1VNKGltcHJlc3Npb25zKSBhcyB0b3RhbF9pbXByZXNzaW9ucyxcbiAgICAgICAgU1VNKGNvbnZlcnNpb25zKSBhcyB0b3RhbF9jb252ZXJzaW9ucyxcbiAgICAgICAgUk9VTkQoU1VNKHNwZW5kKSAvIE5VTExJRihTVU0oY29udmVyc2lvbnMpLCAwKSwgMikgYXMgb3ZlcmFsbF9jYWMsXG4gICAgICAgIFJPVU5EKFNVTShzcGVuZCkgLyBOVUxMSUYoU1VNKGNsaWNrcyksIDApLCAyKSBhcyBvdmVyYWxsX2NwYyxcbiAgICAgICAgUk9VTkQoU1VNKGNsaWNrcykgLyBOVUxMSUYoU1VNKGltcHJlc3Npb25zKSwgMCkgKiAxMDAsIDIpIGFzIG92ZXJhbGxfY3RyLFxuICAgICAgICBST1VORChTVU0oY29udmVyc2lvbnMpIC8gTlVMTElGKFNVTShjbGlja3MpLCAwKSAqIDEwMCwgMikgYXMgb3ZlcmFsbF9jdnJcbiAgICAgIEZST00gJHt0YWJsZU5hbWV9XG4gICAgICBXSEVSRSBkYXRlID49IERBVEVfU1VCKENVUlJFTlRfREFURSgpLCBJTlRFUlZBTCAke2RheXNJbnR9IERBWSlcbiAgICBgO1xuXG4gICAgLy8gRXhlY3V0ZSB0aGUgcXVlcnkgd2l0aCB1c2VyJ3MgYWNjZXNzIHRva2VuXG4gICAgY29uc3QgYmlncXVlcnkgPSBhd2FpdCBnZXRCaWdRdWVyeUNsaWVudFdpdGhUb2tlbihzZXNzaW9uLmFjY2Vzc1Rva2VuIGFzIHN0cmluZyk7XG4gICAgY29uc3QgW3Jvd3NdID0gYXdhaXQgYmlncXVlcnkucXVlcnkoe1xuICAgICAgcXVlcnksXG4gICAgICBsb2NhdGlvbjogcHJvY2Vzcy5lbnYuQklHUVVFUllfTE9DQVRJT04gfHwgJ1VTJyxcbiAgICB9KTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwZXJpb2Q6IGBMYXN0ICR7ZGF5c30gZGF5c2AsXG4gICAgICBtZXRyaWNzOiByb3dzWzBdLFxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdNZXRyaWNzIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBIYW5kbGUgc3BlY2lmaWMgQmlnUXVlcnkgZXJyb3JzXG4gICAgaWYgKGVycm9yLmNvZGUgPT09IDQwNCkge1xuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRGF0YXNldCBvciB0YWJsZSBub3QgZm91bmQuIFBsZWFzZSBjaGVjayB5b3VyIEJpZ1F1ZXJ5IGNvbmZpZ3VyYXRpb24uJyxcbiAgICAgICAgY29kZTogJ1JFU09VUkNFX05PVF9GT1VORCcsXG4gICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIHN1Z2dlc3Rpb246ICdWZXJpZnkgeW91ciBQUk9KRUNUX0lELCBEQVRBU0VUX0lELCBhbmQgVEFCTEVfSUQgaW4gdGhlIGVudmlyb25tZW50IHZhcmlhYmxlcy4nXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gNDAzKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMykuanNvbih7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkIHRvIEJpZ1F1ZXJ5IHJlc291cmNlLicsXG4gICAgICAgIGNvZGU6ICdBQ0NFU1NfREVOSUVEJyxcbiAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgc3VnZ2VzdGlvbjogJ0Vuc3VyZSB5b3VyIEdvb2dsZSBhY2NvdW50IGhhcyBCaWdRdWVyeSBEYXRhIFZpZXdlciBhbmQgSm9iIFVzZXIgcGVybWlzc2lvbnMuJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbImdldFNlcnZlclNlc3Npb24iLCJhdXRoT3B0aW9ucyIsImdldEJpZ1F1ZXJ5Q2xpZW50V2l0aFRva2VuIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInNlc3Npb24iLCJhY2Nlc3NUb2tlbiIsImRheXMiLCJxdWVyeSIsImRheXNJbnQiLCJwYXJzZUludCIsInRhYmxlTmFtZSIsInByb2Nlc3MiLCJlbnYiLCJQUk9KRUNUX0lEIiwiREFUQVNFVF9JRCIsIlRBQkxFX0lEIiwiYmlncXVlcnkiLCJyb3dzIiwibG9jYXRpb24iLCJCSUdRVUVSWV9MT0NBVElPTiIsInN1Y2Nlc3MiLCJwZXJpb2QiLCJtZXRyaWNzIiwiY29uc29sZSIsImNvZGUiLCJkZXRhaWxzIiwibWVzc2FnZSIsInN1Z2dlc3Rpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/metrics/overview.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1"], () => (__webpack_exec__("(api)/./node_modules/.pnpm/next@14.0.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Foverview&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmetrics%2Foverview.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();